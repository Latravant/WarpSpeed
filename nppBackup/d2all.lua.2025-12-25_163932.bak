_addon.name = 'D2all'
_addon.author = 'Latravant (Ragnarok)'
_addon.command = 'd2all'
_addon.language = 'English'

include('zones.lua')

windower.register_event('addon command', function(...)
    command = command and command:lower()
    local args = {...}
    if command == 'd2all' then	
        local party = T(windower.ffxi.get_party())
        local zone = windower.ffxi.get_info().zone
		if member and member.zone == zone then
		return member
		end
	end	

    local spell_recasts = windower.ffxi.get_spell_recasts()
	if player.main_job == 'BLM' or player.sub_job == 'BLM' and spell_recasts[262] < spell_latency then
		windower.chat.input('/ma "Warp ii" '..target) return true		
	else 
		windower.chat.input(123,'Unable to cast warp:'''[player.main_job]'/'[player.sub_job]..'')
	end
	
	return false
end)

windower.register_event('load', function()
    windower.send_command('alias d2all lua c d2all')
end)

windower.register_event('unload', function()
    windower.send_command('unalias d2all')
end)