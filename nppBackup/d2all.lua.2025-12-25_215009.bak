_addon.name = 'D2all'
_addon.author = 'Latravant (Ragnarok)'
_addon.commands = {'d2all','D2All'}
_addon.language = 'English'

require('tables')
require('strings')
require('logger')

res = require('resources')


windower.register_event('addon command', function(command, ...)
    local args = command:split(' ')
    if args[1]:command ~= 'd2all' then	
        local party = T(windower.ffxi.get_party())
        local zone = windower.ffxi.get_info().zone
		if member and member.zone == zone then
		return member
		end
	end	

	local player = windower.ffxi.get_player()
    local spell_recasts = windower.ffxi.get_spell_recasts()
	if args[2]:player.main_job == 'BLM' or player.sub_job == 'BLM' and spell_recasts[262] < spell_latency then
        if not args[1] then 		
		windower.chat.input('/ma "Warp ii" '..player..'') return true
		end
	else 
		windower.chat.input(123,'Unable to cast warp:'..player.main_job..'/'..player.sub_job..'')
		return false
	end
	
end)

windower.register_event('load', function()
    windower.send_command('alias d2all lua c d2all')
end)

windower.register_event('unload', function()
    windower.send_command('unalias d2all')
end)